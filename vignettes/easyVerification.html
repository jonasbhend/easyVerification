<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Introduction</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h2>Introduction</h2>

<p>This package provides functions to simplify application of forecast verification metrics to large datasets of ensemble forecasts. The design goals of <code>easyVerification</code> are:</p>

<ul>
<li><strong>Flexibility:</strong> a variety of data structures are supported</li>
<li><strong>Ease of use:</strong> Absolute forecasts and observations are converted to category and probability forecasts based on the threshold or probability (e.g. terciles) provided, ouputs are reformatted to fit the input</li>
<li><strong>Convenience and flexibility over speed:</strong> R&#39;s built-in vectorisation is used where possible but more importantly, new metrics should be easy to implement</li>
</ul>

<p>Forecast metrics are imported from the <code>SpecsVerification</code> package. Additional verification metrics not available through <code>SpecsVerification</code> are implemented directly. You can check the forecast metrics included in <code>easyVerification</code> as follows:</p>

<pre><code class="r">  suppressPackageStartupMessages(library(easyVerification))
  ls(pos=&quot;package:easyVerification&quot;)
#&gt;  [1] &quot;convert2prob&quot; &quot;count2prob&quot;   &quot;Ens2AFC&quot;      &quot;EnsCorr&quot;     
#&gt;  [5] &quot;EnsError&quot;     &quot;EnsErrorss&quot;   &quot;EnsMae&quot;       &quot;EnsMaess&quot;    
#&gt;  [9] &quot;EnsMe&quot;        &quot;EnsMess&quot;      &quot;EnsMse&quot;       &quot;EnsMsess&quot;    
#&gt; [13] &quot;EnsRmse&quot;      &quot;EnsRmsess&quot;    &quot;EnsRoca&quot;      &quot;EnsRocss&quot;    
#&gt; [17] &quot;EnsSprErr&quot;    &quot;FairSprErr&quot;   &quot;toyarray&quot;     &quot;toymodel&quot;    
#&gt; [21] &quot;veriApply&quot;
</code></pre>

<p>At the time of publication these forecast skill metrics were included:</p>

<ol>
<li>Mean error (<code>EnsMe</code>), mean absolute error(<code>EnsMae</code>), mean squared error (<code>EnsMse</code>), and root mean squared error (<code>EnsRmse</code>) of the ensemble mean and their skill scores (e.g. <code>EnsRmsess</code>)</li>
<li>Correlation with the ensemble mean (<code>EnsCorr</code>)</li>
<li>Spread to error ratio (<code>EnsSprErr</code>)</li>
<li>Are under the ROC curve (<code>EnsRoca</code>) and its skill score (<code>EnsRocss</code>)</li>
</ol>

<p>In addition, the following forecast scores from <code>SpecsVerification</code> can be used:</p>

<ol>
<li>Fair (<code>FairRps</code>) and standard (<code>EnsRps</code>) rank probability scores and skill scores (e.g. <code>FairRpss</code>)</li>
<li>Fair (<code>FairCrps</code>) and standard (<code>EnsCrps</code>) continuous ranked probability scores and skill scores (e.g. <code>FairCrpss</code>)</li>
</ol>

<p>Additional forecast verification metrics can be added by the user. This is illustrated in Section XX of this document.</p>

<h2>Installation</h2>

<p>You can get the latest version from CRAN</p>

<pre><code class="r">install.packages(&quot;easyVerification&quot;)
</code></pre>

<p>You can get the latest development version using</p>

<pre><code class="r">devtools::install_github(&quot;MeteoSwiss/easyVerification&quot;)
</code></pre>

<h2>First steps with <code>veriApply</code></h2>

<p>The workhorse of the <code>easyVerification</code> package is a function called <code>veriApply</code>. It is used to apply the functions that compute forecast scores and skill scores to large arrays of ensemble forecasts and corresponding observations. The following example illustrates how to compute the continous ranked probability skill score of an ensemble forecast using <code>veriApply</code>. </p>

<p>First, let&#39;s generate an ensemble of forecasts and corresponding verifying observations. We assume that there are 100 spatial locations (or lead times or a combination ot these), 30 forecasts instances (forecast times), and 51 ensemble members. The ensemble forecast is furthermore unbiased and well calibrated. Forecast-observation pairs can be generated using the <code>toymodel</code> and <code>toyarray</code> functions.</p>

<pre><code class="r">tm &lt;- toyarray(dims=100, N=30, nens=51)
## inspect the toy model object
str(tm)
#&gt; List of 2
#&gt;  $ fcst: num [1:100, 1:30, 1:51] 0.869 1.014 0.786 0.309 -0.275 ...
#&gt;  $ obs : num [1:100, 1:30] 0.5065 0.3902 -0.7168 0.1825 -0.0212 ...
</code></pre>

<p>Next, we compute the continuous ranked probability score (CRPS). This score operates using absolute values of the forecast and observation and no conversion to probabilities is thus required. We use the unbiased (fair) version of the CRPS from the <code>SpecsVerification</code> package.</p>

<pre><code class="r">f.crps &lt;- veriApply(&quot;FairCrps&quot;, fcst=tm$fcst, obs=tm$obs)
</code></pre>

<p>If we were to compute the ranked probability score (RPS) instead, either percentiles of the climatology or absolute thresholds have to be supplied to convert the continuous forecasts and observations into category forecasts previous to the analysis. Percentiles of the climatology are provided using the additional argument <code>prob=...</code>, absolute thresholds using <code>threshold=...</code>. The percentiles are computed on the forecast instances (here the 2nd dimension of <code>fcst</code> and <code>obs</code>) using <code>convert2prob</code>.</p>

<pre><code class="r">f.rps &lt;- veriApply(&quot;FairRps&quot;, fcst=tm$fcst, obs=tm$obs, prob=c(1/3,2/3))
f.rps2 &lt;- veriApply(&quot;FairRps&quot;, fcst=tm$fcst, obs=tm$obs, threshold=1)
</code></pre>

<p>Finally, to compute skill scores two approaches are supported. First, skill scores are computed by default with reference to climatological forecasts. For this, no additional arguments have to be supplied. Please note, the output of <code>veriApply</code> is of the same data type as the output of the function that is invoked within <code>veriApply</code>. For the RPSS and CRPSS, a list with the skill score and the corresponding standard error of the difference between the score and the reference score are supplied. Thus the output from <code>veriApply</code> for these functions is also a list with the two components. The dimension of the components follows the input dimension as in the examples above.</p>

<pre><code class="r">f.crpss &lt;- veriApply(&quot;FairCrpss&quot;, fcst=tm$fcst, obs=tm$obs)
## some skill scores also include uncertainty information (standard errors)
str(f.crpss)
#&gt; List of 2
#&gt;  $ crpss      : num [1:100(1d)] -0.1137 0.0582 -0.0334 0.0946 -0.0104 ...
#&gt;  $ crpss.sigma: num [1:100(1d)] 0.138 0.0837 0.1019 0.0777 0.0968 ...
range(f.crpss$crpss)
#&gt; [1] -0.2574460  0.2907086
</code></pre>

<p>In addition to computing skill scores against climatological forecasts as the reference, arbitrary ensemble forecasts can be used as a reference. This is achieved by setting the additional argument <code>fcst.ref=...</code> to the reference forecast in <code>veriApply</code>. For example, let&#39;s evaluate the forecast against persistence (of the observations) assuming an anomaly of 0 for observation preceding the first forecast instance.</p>

<pre><code class="r">fcst.ref &lt;- array(cbind(0, tm$obs[,-ncol(tm$obs)]), c(dim(tm$obs), 1))
f.crpss2 &lt;- veriApply(&quot;FairCrpss&quot;, fcst=tm$fcst, obs=tm$obs, fcst.ref=fcst.ref)
par(mar=c(5,5,1,1))
plot(f.crpss$crpss, f.crpss2$crpss, asp=1,
     xlab=&#39;CRPSS against climatology&#39;, ylab=&#39;CRPSS against persistence&#39;)
grid()
abline(c(0,1))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9"/> </p>

<p>The above plot illustrates that the single-valued persistence forecast (i.e. a delta function) is very easy to beat compared to the broad, well-calibrated, but uninformative climatology forecast (i.e. the same forecast probabilities for each forecast instance).</p>

<h2>Handling different data structures</h2>

<p><code>veriApply</code> is able to handle different array-based data structures. The following example illustrates how multi-dimensional forecast arrays can be supplied to <code>veriApply</code>. Consider a forecast array with 4 lead times, 5 longitudes, 6 latitudes, 7 forecast instances and 8 ensemble members. The output from <code>veriApply</code> for a single-valued forecast metric (e.g. mean bias) thus has the dimension 4 x 5 x 6.</p>

<pre><code class="r">fcst &lt;- array(rnorm(prod(4:8)), 4:8)
obs &lt;- array(rnorm(prod(4:7)), 4:7)
f.me &lt;- veriApply(&#39;EnsMe&#39;, fcst=fcst, obs=obs)
dim(f.me)
#&gt; [1] 4 5 6
</code></pre>

<p>Alternatively, if the same forecasts and observations are stored as 8 ensemble members, 4 lead times, 7 forecast instances, 5*6 spatial locations, the mean error can be computed by supplying the additional arguments <code>tdim</code> and <code>ensdim</code> to indicate which of the array dimensions contains the forecast instances (<code>tdim</code>) and ensemble members (<code>ensdim</code>).</p>

<pre><code class="r">fcst2 &lt;- array(aperm(fcst, c(5,1,4,2,3)), c(8, 4, 7, 5*6))
obs2 &lt;- array(aperm(obs, c(1,4,2,3)), c(4,7,5*6))
f.me2 &lt;- veriApply(&#39;EnsMe&#39;, fcst=fcst2, obs=obs2, tdim=3, ensdim=1)
dim(f.me2)
#&gt; [1]  4 30
</code></pre>

<p>We can check that the restructuring produced the same output (with different dimensionality):</p>

<pre><code class="r">range(c(f.me) - c(f.me2))
#&gt; [1] 0 0
</code></pre>

<h2>Adding user-defined verification functions</h2>

<p>User-defined functions can be easily included in the <code>veriApply</code> workflow. All one has to do is to follow the template provided by any of the verification functions already available. In general, the data structure will be important in that <code>veriApply</code> assumes that the input arguments to the user-defined function is a matrix of forecasts and a vector of verifying observations along with additional arguments. Lets illustrate the approach by writing a function that computes the index of the ensemble member with the smallest absolute difference to the corresponding verifying observation for each forecast instance.</p>

<pre><code class="r">bestMember &lt;- function(ens, obs){
  best &lt;- apply(abs(ens - obs), 1, which.min)
  return(best)
}
</code></pre>

<p>We can now call this function on the previously used forecast and observation pairs and check that the maximum index returned does not exceed the number of ensemble members available (here 8).</p>

<pre><code class="r">f.best &lt;- veriApply(&quot;bestMember&quot;, fcst=fcst, obs=obs)
range(f.best)
#&gt; [1] 1 8
</code></pre>

<p>Functions using a forecast matrix and observation vector as input and returning either a single value, a list, or a vector of the same length as the observations can be used with <code>veriApply</code> as long as the arguments are named as in the example above and argument names do not conflict with argument names used in <code>veriApply</code>. Please note that if your function name ends in <code>...ss</code>, the assumption is that you are trying to compute a skill score and therefore a reference forecast will be supplied (i.e. the climatological forecast by default). </p>

</body>

</html>

